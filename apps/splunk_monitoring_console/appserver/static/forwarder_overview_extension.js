require(["jquery","underscore","splunkjs/mvc","splunkjs/mvc/simplexml/ready!","uri/route","splunkjs/mvc/sharedmodels","backbone","splunkjs/mvc/utils","collections/services/saved/Searches","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/controls/SyntheticCheckboxControl","splunkjs/mvc/savedsearchmanager"],function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_2__,__WEBPACK_EXTERNAL_MODULE_3__,__WEBPACK_EXTERNAL_MODULE_5__,__WEBPACK_EXTERNAL_MODULE_6__,__WEBPACK_EXTERNAL_MODULE_7__,__WEBPACK_EXTERNAL_MODULE_10__,__WEBPACK_EXTERNAL_MODULE_13__,__WEBPACK_EXTERNAL_MODULE_16__,__WEBPACK_EXTERNAL_MODULE_25__,__WEBPACK_EXTERNAL_MODULE_26__,__WEBPACK_EXTERNAL_MODULE_27__,__WEBPACK_EXTERNAL_MODULE_28__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}({0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1),__webpack_require__(2),__webpack_require__(3),__webpack_require__(13),__webpack_require__(7),__webpack_require__(16),__webpack_require__("splunk_monitoring_console-views/settings/forwarder_setup/lite/dialogs/Master"),__webpack_require__(5)],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,mvc,utils,SharedModels,SavedSearchesCollection,SetupModal){var $setupButton=$('<a class="btn pull-right primary-btn" href="#" target="_blank"><i class="icon icon-gear"></i> Setup</a>'),savedSearchesCollection=new SavedSearchesCollection,serverInfo=SharedModels.get("serverInfo"),application=SharedModels.get("app");$(".dashboard-header h2").before($setupButton);var fetchSavedSearch=function(successFn){savedSearchesCollection.fetch({data:{app:"splunk_monitoring_console",owner:"nobody",search:'name="DMC Forwarder - Build Asset Table"'},success:successFn,error:function(){throw new Error("Savedsearch fetch failed")}})};$setupButton.click(function(e){e.preventDefault(),fetchSavedSearch(function(collection){savedSearchesCollection.add([collection.models[0]]),$.when(serverInfo.dfd,application.dfd).then(function(){setupModal&&(setupModal.hide(),setupModal=null);var setupModal=new SetupModal({backdrop:"static",keyboard:!0,model:{application:application,savedSearch:savedSearchesCollection.models[0],serverInfo:serverInfo},onHiddenRemove:!0});$("body").append(setupModal.render().el),setupModal.show()})})})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},1:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_1__},2:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_2__},3:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_3__},5:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_5__},"splunk_monitoring_console-views/settings/forwarder_setup/lite/dialogs/Master":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1),__webpack_require__(2),__webpack_require__(10),module,__webpack_require__(26),__webpack_require__(25),__webpack_require__(27),__webpack_require__(28),__webpack_require__(6),__webpack_require__(29)],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,Backbone,module,Modal,ControlGroup,SyntheticCheckboxControl,SavedSearchManager,route,Template){return Modal.extend({moduleId:module.id,template:Template,initialize:function(){Modal.prototype.initialize.apply(this,arguments)},events:$.extend({},Modal.prototype.events,{"click .btn-apply-setup":"_applySetup","click .checkbox-enable-or-disable-forwarder-monitoring":"_enableOrDisableMonitoring"}),_enableOrDisableMonitoring:function(){0==this.children.enableForwarderMonitoringCheckbox.getValue()?(this.$(".data-collection-interval").removeClass("disabled"),this.$(".dropdown-toggle").addClass("disabled")):this.children.dataCollectionInterval.enable()},_updateFormStyle:function(){this.model.savedSearch.fetch({success:function(){this.model.savedSearch.entry.content.get("disabled")?(this.children.enableForwarderMonitoringCheckbox.setValue(0),this.children.dataCollectionInterval.disable()):(this.children.enableForwarderMonitoringCheckbox.setValue(1),this.children.dataCollectionInterval.enable())}.bind(this),error:function(){}.bind(this)})},_applySetup:function(){0==this.children.enableForwarderMonitoringCheckbox.getValue()?(this.model.savedSearch.entry.content.set("disabled",1),this.model.savedSearch.save({},{success:function(){document.location.href=route.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),"monitoringconsole_forwarder_setup")}.bind(this)})):(this.model.savedSearch.entry.content.set("disabled",0),this.model.savedSearch.save({},{success:function(){this.searchManager=new SavedSearchManager({searchname:"DMC Forwarder - Build Asset Table"}),this.searchManager.on({"search:cancelled":function(){},"search:done":function(){document.location.href=route.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),"forwarder_overview")},"search:error":function(){},"search:failed":function(){}},this)}.bind(this)}))},render:function(){return this.$el.html(Modal.TEMPLATE),this.$(Modal.BODY_SELECTOR).html(this.compiledTemplate({serverInfo:this.model.serverInfo,isModal:!0})),this.children.enableForwarderMonitoringCheckbox=new SyntheticCheckboxControl({label:_("Enable Forwarder Monitoring").t(),defaultValue:!this.model.savedSearch.entry.content.get("disabled")}),this.children.toggleSavedSearch=new ControlGroup({label:_("Forwarder Monitoring").t(),controlType:"SyntheticRadio",controlOptions:{model:this.model.savedSearch.entry.content,modelAttribute:"disabled",items:[{label:_("Disable").t(),value:!0},{label:_("Enable").t(),value:!1}]}}),this.children.dataCollectionInterval=new ControlGroup({label:_("Fetch data every").t(),controlType:"SyntheticSelect",controlOptions:{model:this.model.savedSearch.entry.content,modelAttribute:"cron_schedule",items:[{label:_("15 minutes").t(),value:"3,18,33,48 * * * *"},{label:_("30 minutes").t(),value:"18,48 * * * *"},{label:_("1 hour").t(),value:"18 * * * *"},{label:_("2 hours").t(),value:"18 */2 * * *"},{label:_("4 hours").t(),value:"18 */4 * * *"},{label:_("8 hours").t(),value:"18 */8 * * *"},{label:_("12 hours").t(),value:"18 */12 * * *"},{label:_("24 hours").t(),value:"18 5 * * *"}],menuWidth:"narrow",toggleClassName:"btn"}}),this.$(Modal.BODY_SELECTOR).find(".section-description").prepend(this.children.enableForwarderMonitoringCheckbox.render().$el),this.children.enableForwarderMonitoringCheckbox.$el.addClass("checkbox-enable-or-disable-forwarder-monitoring"),this.children.dataCollectionInterval.$el.addClass("data-collection-interval"),this.$(Modal.BODY_SELECTOR).find(".forwarder-monitoring-settings").append(this.children.dataCollectionInterval.render().$el),this.$(Modal.HEADER_TITLE_SELECTOR).html(_("Forwarder Monitoring Setup").t()),this.$(Modal.FOOTER_SELECTOR).html('<a href="#" class="btn btn-primary modal-btn-primary btn-apply-setup pull-right">'+_("Apply").t()+"</a>"),this.$(Modal.FOOTER_SELECTOR).prepend(Modal.BUTTON_CANCEL),this.$(Modal.BUTTON_CLOSE_SELECTOR).remove(),this.$(Modal.BODY_SELECTOR).removeClass(),this._updateFormStyle(),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},6:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_6__},7:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_7__},10:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_10__},13:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_13__},16:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_16__},25:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_25__},26:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_26__},27:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_27__},28:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_28__},29:function(module,exports){module.exports='<% if (!isModal) { %>\n\t<div class="section-header section-padded page-heading">\n\t\t<h2 class="section-title">\n\t\t\t<%= _("Forwarder Monitoring").t() %>\n\t\t</h2>\n\t</div>\n<% } %>\n\n<div class="section-padded">\n\t<div class="section-description">\n\t\t<p><%= _(\'If you enable forwarder monitoring, a scheduled search named \').t() %>"DMC Forwarder - Build Asset Table"<%= _(\' will be enabled. This may affect the search workload.\').t() %></p>\n\t</div>\n\n\t<div class="form form-horizontal forwarder-monitoring-settings"></div>\n\t\t<% if (!isModal) { %>\n\t\t\t<div class="dmc-forwarder-setup-button-section">\n\t\t\t\t<a class="btn btn-primary btn-start-forwarder-monitoring disabled"><%= _(\'Start Monitoring\').t() %></a>\n\t\t\t</div>\n\t\t<% } %>\n</div>\n'}})});